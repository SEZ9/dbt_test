version: 2

semantic_models:
  - name: user_sales_summary_semantic
    model: ref('sales_with_date')  # 引用生成的 sales_with_date 表
    description: "A semantic model representing user sales summary"
    primary_entity: user
    entities:
      - name: user
        type: primary
        expr: user_id
    measures:
      - name: total_sales_value
        description: "Total value of sales across all users"
        agg: sum
        expr: total_sales_value
      - name: total_tickets_sold
        description: "Total number of tickets sold"
        agg: sum
        expr: total_tickets_sold
    dimensions:
      - name: user_name
        description: "The name of the user"
        type: categorical
        expr: username
      - name: sale_date
        description: "The date when the sale occurred"
        type: time
        expr: date_day  # 直接使用 date 表的 date_day 字段
        time_granularity: day  # 按天粒度
