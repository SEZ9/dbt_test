version: 2

metrics:
  - name: total_sales_value
    label: "Total Sales Value"
    description: "Total value of sales across all users"
    type: sum
    sql: total_sales_value  # 来自 user_sales_summary 的总销售金额
    model: ref('user_sales_summary')
    timestamp: last_sale_time  # 使用用户最后一次销售的时间
 

  - name: total_tickets_sold
    label: "Total Tickets Sold"
    description: "Total number of tickets sold across all users"
    type: sum
    sql: total_tickets_sold  # 来自 user_sales_summary 的总门票数量
    model: ref('user_sales_summary')
    timestamp: last_sale_time

  - name: average_ticket_price
    label: "Average Ticket Price"
    description: "Average price per ticket for all sales"
    type: average
    sql: average_ticket_price  # 来自 event_sales_summary 的平均票价
    model: ref('event_sales_summary')
    timestamp: event_last_sale_time  # 按事件的最后销售时间

  - name: total_sales_value_per_event
    label: "Total Sales Value Per Event"
    description: "Total sales value for each event"
    type: sum
    sql: total_sales_value  # 来自 event_sales_summary 的总销售金额
    model: ref('event_sales_summary')
    dimensions:
      - event_id  # 按事件维度分组
    timestamp: event_last_sale_time

